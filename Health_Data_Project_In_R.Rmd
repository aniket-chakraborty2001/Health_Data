---
Author: "Aniket Chakraborty"
Last Updated: "06/06/2023" or "6th June 2023" 
title: "R Notebook on Health Data"
output: html_notebook
---
### Here we will install and load the required packages, tidyverse,dplyr,ggplot2

```{r Installing & loading packages}
install.packages("tidyverse")
library(tidyverse)
library(dplyr)
library(ggplot2)
```
### Here we will read the csv file named as "Health_Data.csv". Note that this file is in the same directory where the R system lies. So we do not need to mention the file path. Rather using the file name we can do it.

```{r Reading csv file}
health_df <- read.csv("Health_Data.csv")
```

### The next few steps contains the step of understanding data. It includes how is the data, what are the type of each variable in the data, what are the summary statistics of the data. It also includes discovering the number of columns and number of rows in the data set.

#### View() function is used to view or preview the data in a separate tab

```{r Previewing the data frame}
View(health_df)
```

#### str() function is used to know the structure of each variable in the data set

```{r Observing the structure}
str(health_df)
```
#### summary() function is used to know the statistical summary of each numerical or continuous variable that are present in the data set. We may also use the glimpse() function in this case. Both of them will do the same work.

```{r Getting Summary Statistics}
summary(health_df)
```
#### colnames() function is used to know the column names or variable names of the data set.

```{r Getting the columns names}
colnames(health_df)
```
#### nrow() function is used to know the number of observations available in the data set
#### ncol() function is used to know the number of variables available in the data set.

```{r Getting Row and column numbers}
nrow(health_df)
ncol(health_df)
```

### From here we start the data cleaning and manipulation works. For this we load the dplyr library and we use functions to create a column, filter values from column, select column, group them and summarize them with a piping operator.


#### mutate() function is used to create a new variable that carries some values tat we get from other present variables.

```{r Using mutate() function to add another variable}
health_01_df <- health_df %>% mutate(Doc_received=Bill_amount-Hospital_received)
head(health_01_df)

```

#### mutate() with ifelse is used to create a variable that contians string values based on certain condition.

```{r Using mutate() function with ifelse condition}
health_02_df <- health_01_df %>% mutate(Feedback=ifelse(Bill_amount > mean(Bill_amount),'Bad','Good'))
head(health_02_df)
```
#### Using group_by() and count() we can calculate total occurrence of different values in a data set.

```{r Counting the Number of feedbacks}
health_02_df %>% group_by(Feedback) %>% count()
```

#### select() function is used to select different variables and help to perform data manipulation

```{r Using select() function}
health_02_df %>% select(Age,Disease,Duration._of_disease)
```

#### rename() function is used to rename a variable into another variable. In other words rename function assigns new names to the same variable.

```{r Using rename() function}
health_final_df <- health_02_df %>% rename(Duration_of_disease = Duration._of_disease)
head(health_final_df)
```
```{r Checking the column names of the latest data frame}
colnames(health_final_df)
```
#### filter() is used to filter values that lies in observations depending on one or more condition.

```{r Using filter() function on Age and Duration_Of_Diseases}
health_final_df %>% filter(Age < 30 & Duration_of_disease < 2)
```
#### we can also use filter() function to filter string values.

```{r Using filter() function on Disease and Gender}
health_final_df %>% filter(Disease == 'Diabetics' & Gender == 'Female')
```
#### group_by() function is used to make calculations of each parameter separately.
#### summarize() is used to get Statistical and Mathematical values of variables.


```{r Using groiup_by and summarize() function}
health_final_df %>% group_by(Gender) %>% summarize(avg_bill=mean(Bill_amount),min_bill=min(Bill_amount),max_bill=max(Bill_amount))
```

```{r Statistics on Hospital Bill}
health_final_df %>% group_by(Gender) %>% summarize(avg_hospital=mean(Hospital_received),min_hospital=min(Hospital_received),max_hospital=max(Hospital_received))
```

```{r Statistics on Doctor Receice}
health_final_df%>%group_by(Gender)%>%summarize(avg_doc=mean(Doc_received),min_doc=min(Doc_received),max_doc=max(Doc_received))
```
### Starting of Data Analysis
#### ggplot() is the function used to plot graph of variables. Which plot object is to used depends upon what we are interested to do. geom_point() refers to the scatter plot and labs() refers to adding title,labels, subtitle etc.Facet_wrap() is used to separate the plot depending on the parameter used in the function.

```{r Plotting dot plot for each gender}
p1=ggplot(data= health_final_df)+ geom_point(mapping=aes(x= Age,y=Bill_amount,color= Gender),size=5)+labs(title="Distribution of Bill with respect to Age",x="Age",y="BillAmount")+facet_wrap(~Feedback)
p1
```

```{r Making a Data frame having age<30 and disease Diabetics}
health_sp <- health_final_df %>% filter(Age<30 & Disease =='Diabetics') %>% select(Age,Disease)
View(health_sp)
```
#### Here we plot a bar chart. First we break the Age variable in some range, so that we can easily plot the bar graph. Here we see the frequency (count).

```{r Plotting Diabetics With Age_Range}
age_range <- cut(health_sp$Age, breaks=c(0, 6, 12, 20, 25, 30))
age_range
p2=ggplot(data=health_sp)+geom_bar(mapping=aes(x=age_range,fill=Disease))+ labs(x="Age Range", y="No. of People with Disease")
p2
```
#### Here we count the total number of diseases separately. We treate them as values in the next plot

```{r Getting total number of different diseases}
health_final_df %>% group_by(Disease) %>% count()
```

#### Here we plot a pie chart. We use the count as the values and labels them as the disease name. We use three different colors and labeling to understand the pie chart efficiently.

```{r Pie chart of disease contribution in data}
values <- c(39,26,35)
labels <- c('Diabetics','Pressure','Thyroid')
radius <- 1
colors <- c('red','blue','gold')
main <- 'Distribution of Disease in the popiulation'
percentages <- round(values/sum(values)*100,2)
p3=pie(values,labels,radius=radius,main=main,col=colors)
p3
```













